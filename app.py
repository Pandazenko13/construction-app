import streamlit as st
import pandas as pd
from datetime import datetime

st.set_page_config(page_title="Î•Î½ÎµÏÎ³Î­Ï‚ Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚", page_icon="ğŸ”§")

st.title("ğŸ“… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î•Î½ÎµÏÎ³ÏÎ½ Î•ÏÎ³Î±ÏƒÎ¹ÏÎ½ Î•ÏÎ³Î¿Ï„Î±Î¾Î¯Î¿Ï…")

# ğŸ“‚ Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… Excel
uploaded_file = st.file_uploader("Î‘Î½Î­Î²Î±ÏƒÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Excel", type=["xlsx"])

if uploaded_file:
    try:
        # ğŸ“Š Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ· ÎºÎ±Î¹ Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½
        df = pd.read_excel(uploaded_file)
        df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚"] = pd.to_datetime(df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚"])
        df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚"] = pd.to_datetime(df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚"])
        
        # ğŸ“† Î•Ï€Î¹Î»Î¿Î³Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
        selected_date = st.date_input("ğŸ“Œ Î”Î¹Î¬Î»ÎµÎ¾Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î³Î¹Î± Î­Î»ÎµÎ³Ï‡Î¿", value=datetime.today())
        selected_date = pd.to_datetime(selected_date)  # ğŸ›  ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î³Î¹Î± ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ·
        
        # ğŸ” Î¦Î¹Î»Ï„ÏÎ¬ÏÎ¹ÏƒÎ¼Î± ÎµÎ½ÎµÏÎ³ÏÎ½ ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½
        mask = (df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚"] <= selected_date) & (df["Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚"] >= selected_date)
        ÎµÎ½ÎµÏÎ³Î­Ï‚ = df[mask]
        
        if ÎµÎ½ÎµÏÎ³Î­Ï‚.empty:
            st.warning(f"â›” Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÎ½ÎµÏÎ³Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÏƒÏ„Î¹Ï‚ {selected_date.date()}.")
        else:
            st.success(f"âœ… Î•Î½ÎµÏÎ³Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÏƒÏ„Î¹Ï‚ {selected_date.date()}:")
            st.dataframe(ÎµÎ½ÎµÏÎ³Î­Ï‚[["Î•ÏÎ³Î±ÏƒÎ¯Î±", "Î£Ï…Î½ÎµÏÎ³ÎµÎ¯Î¿", "Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚", "Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚"]])

    except Exception as e:
        st.error(f"âš ï¸ Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î·Î½ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ· Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï…: {e}")
else:
    st.info("â• Î ÎµÏÎ¹Î¼Î­Î½Ï‰ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÎ¹Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿ Excel...")
